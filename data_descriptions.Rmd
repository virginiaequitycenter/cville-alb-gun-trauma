---
title: "Data Descriptions"
author: Samantha Toet
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggmap)
library(janitor)
library(lubridate)
library(reactable)
library(tidyverse)
```
### Gun Violence Archive 

The national [Gun Violence Archive](https://www.gunviolencearchive.org/) describes gun violence as:

>"all incidents of death or injury or threat with firearms... Violence is defined without intent or consequence as a consideration. To that end a shooting of a victim by a subject/suspect is considered gun violence as is a defensive use or an officer involved shooting. The act itself, no matter the reason is violent in nature."

This database includes information collected from public news sources about 201 incidents of gun violence in the Charlottesville/Albemarle region from  May 2014 - Feb 2024. The incidents range from shots fired reports, to unlawful gun ownership, to acts of violence such as assault, suicide, and homicide.

Because the data is sourced from public news websites, if an act of violence didn't receive local news attention it was not included in the Gun Violence Archive database. That means this data underrepresents some information, especially shots fired numbers. Notably, it looks like shots fired incidents haven't been added to the database since 2021. 

The data is made up of two dataframes: one has information about each incident and the associated outcome variables (for example, the number of people injured and/or killed), and the other lists the participant-level information (for example, the age rage and gender of the participants. The data includes the geocoded location and date of each incident and the characteristics of each incident (for example, injury, homicide, or shots fired). The data does not give any information about the race, ethnicity, socioeconomic status, or mental health status of any of the participants. 

```{r gva_incidents, echo=FALSE, message=FALSE}

# Incidents ----
gva_incidents <- read_csv("data/gva_incidents.csv") %>%
  clean_names() 

# Geocode ----
#gva_lonlat <- geocode(gva_incidents$address) 
#sum(is.na(gva_lonlat$lon)) #59 NAs and some that look pretty wonky, will need to revisit 

# Map ---- (on hold pending geocode fix)
# cville_map <- get_map(c(left = -78.53, bottom = 38.00, right = -78.45, top = 38.07), maptype = "roadmap", color = "bw")
# 
# ggmap(cville_map) +
#   stat_density2d(data = gva_incidents, aes(fill = ..level.., alpha = 0.01),
#                  geom = "polygon") +
#   geom_point(data = gva_incidents, aes(x = lon, y = lat), size = 1, alpha = 0.2)

# Outcome numbers ----
gva_incidents %>%
  group_by(yr = year(incident_date)) %>%
  summarise(total_injured = sum(victims_injured + suspects_injured),
            total_killed = sum(victims_killed + suspects_killed)) %>%
  ungroup() %>%
  pivot_longer(matches("total")) %>% 
  ggplot(aes(x = yr, y = value, fill = name)) +
  geom_col() +
  scale_fill_discrete(name = "Victim Status",
                      breaks = c("total_injured", "total_killed"),
                      labels = c("Injured", "Killed")) +
  labs(title = "Victims of Gun Violence in Charlottesville",
       x = "Year",
       y = "Number of Victims") +
  theme(axis.text.x = element_text(angle=35))
```

#### Individual-level data

```{r gva_participants, echo=FALSE, message=FALSE}

gva_participants <- read_csv("data/gva_participants.csv") %>%
  clean_names() %>%
  select(-operations, -participant_name, -city_or_county, -state) %>%
  mutate(incident_date = (mdy(incident_date)))

reactable(gva_participants)

```

---

### Charlottesville Open Data Portal 

The Charlottesville Open Data Portal (ODP) includes crime and arrest data for the City of Charlottesville. The data is maintained by the Cville Police Department and is updated nightly. 

<b>What it does not include: Albemarle County Police Data, UVA Police Data</b>

### VA Open Data Portal 
